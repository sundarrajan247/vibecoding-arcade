<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Snake ‚Ä¢ Vibecoding Arcade</title>
  <style>
    :root{--bg:#0b1020;--card:#121935;--text:#e7ecff;--accent:#9ad1ff}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,Segoe UI,Arial;background:var(--bg);color:var(--text);display:grid;place-items:center;min-height:100vh}
    .panel{width:min(96vw,520px);background:var(--card);border:1px solid #1d2750;border-radius:18px;padding:18px}
    h1{margin:0 0 10px;font-size:22px}
    canvas{width:100%;height:auto;background:#0c122a;border-radius:12px;border:1px solid #1d2750;image-rendering:pixelated}
    .row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin:10px 0}
    .btn{flex:1;padding:10px;border-radius:12px;border:1px solid #29408a;background:#17224a;color:var(--text);cursor:pointer}
    .btn:hover{background:#1b2a5c}
    .score{font-weight:600}
    .dpad{margin-top:8px;display:grid;grid-template-columns:repeat(3,60px);grid-template-rows:repeat(3,60px);gap:8px;justify-content:center}
    .dpad button{border-radius:12px;border:1px solid #29408a;background:#17224a;color:var(--text);font-size:18px}
    .dpad button:active{transform:scale(0.98)}
    .center{grid-column:2/3;grid-row:2/3;visibility:hidden}
  </style>
</head>
<body>
  <div class="panel">
    <h1>üêç Snake</h1>
    <div class="row">
      <div class="score">Score: <span id="score">0</span></div>
      <div>Best: <span id="best">0</span></div>
    </div>
    <canvas id="board" width="400" height="400"></canvas>
    <div class="row">
      <button id="start" class="btn">Start / Pause</button>
      <button id="reset" class="btn">Reset</button>
      <a class="btn" href="./index.html">Back</a>
    </div>
    <!-- Touch controls for phones -->
    <div class="dpad" aria-label="Touch Controls">
      <span></span><button id="up">‚ñ≤</button><span></span>
      <button id="left">‚óÄ</button><button class="center">‚Ä¢</button><button id="right">‚ñ∂</button>
      <span></span><button id="down">‚ñº</button><span></span>
    </div>
  </div>

  <script>
  (() => {
    const canvas = document.getElementById('board');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const bestEl  = document.getElementById('best');
    const startBtn= document.getElementById('start');
    const resetBtn= document.getElementById('reset');

    const CELL = 20, CELLS = canvas.width / CELL; // 20x20 grid
    let snake, dir, food, score, best = +localStorage.getItem('snake_best') || 0;
    let speedMs, timer = null, running = false;

    function randCell(){ return Math.floor(Math.random()*CELLS); }

    function newFood(){
      let f;
      do {
        f = { x: randCell(), y: randCell() };
      } while (snake.some(s => s.x===f.x && s.y===f.y));
      food = f;
    }

    function reset(){
      snake = [{x:10,y:10}];
      dir = {x:1,y:0};
      score = 0;
      speedMs = 140; // starts slow, speeds up
      scoreEl.textContent = score;
      newFood();
      draw();
    }

    function startPause(){
      running = !running;
      if (running && !timer) timer = setInterval(tick, speedMs);
      else { clearInterval(timer); timer = null; }
    }

    function changeDir(nx, ny){
      // prevent reversing into self
      if (nx === -dir.x && ny === -dir.y) return;
      dir = {x:nx,y:ny};
    }

    function tick(){
      const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

      // wrap around edges
      head.x = (head.x + CELLS) % CELLS;
      head.y = (head.y + CELLS) % CELLS;

      // collision with self
      if (snake.some((s,i)=> i && s.x===head.x && s.y===head.y)) {
        gameOver();
        return;
      }

      snake.unshift(head);

      // eat?
      if (head.x === food.x && head.y === food.y) {
        score += 1;
        scoreEl.textContent = score;
        best = Math.max(best, score); bestEl.textContent = best;
        localStorage.setItem('snake_best', best);
        newFood();
        speedUp(); // tiny difficulty ramp
      } else {
        snake.pop();
      }

      draw();
    }

    function speedUp(){
      if (speedMs > 70) {
        speedMs -= 5;
        clearInterval(timer);
        timer = setInterval(tick, speedMs);
      }
    }

    function draw(){
      // background
      ctx.fillStyle = '#0c122a';
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // food
      ctx.fillStyle = '#ff6b6b';
      ctx.fillRect(food.x*CELL, food.y*CELL, CELL, CELL);

      // snake
      ctx.fillStyle = '#9ad1ff';
      snake.forEach((p,i)=>{
        ctx.fillRect(p.x*CELL, p.y*CELL, CELL-1, CELL-1);
      });
    }

    function gameOver(){
      running = false;
      clearInterval(timer); timer = null;
      ctx.fillStyle = 'rgba(0,0,0,0.5)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      ctx.textAlign = 'center';
      ctx.font = '20px system-ui, Segoe UI';
      ctx.fillText('Game Over ‚Äî press Reset', canvas.width/2, canvas.height/2);
    }

    // Controls
    window.addEventListener('keydown', (e) => {
      const k = e.key;
      if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight',' '].includes(k)) e.preventDefault();
      if (k === ' ') startPause();
      else if (k === 'ArrowUp') changeDir(0,-1);
      else if (k === 'ArrowDown') changeDir(0,1);
      else if (k === 'ArrowLeft') changeDir(-1,0);
      else if (k === 'ArrowRight') changeDir(1,0);
    });

    // Touch buttons
    [['up',0,-1],['down',0,1],['left',-1,0],['right',1,0]].forEach(([id,x,y])=>{
      document.getElementById(id).addEventListener('click', ()=> changeDir(x,y));
    });

    startBtn.onclick = startPause;
    resetBtn.onclick = ()=>{ reset(); running=false; clearInterval(timer); timer=null; };

    // boot
    bestEl.textContent = best;
    reset();
  })();
  </script>
</body>
</html>
